<table class=" grill schedule table table-hover table-striped">
  <thead>
    <tr>
      <th class="no-day"></th>
      <th class="day">MONDAY</th>
      <th class="day">TUESDAY</th>
      <th class="day">WEDNESDAY</th>
      <th class="day">THURSDAY</th>
      <th class="day">FRIDAY</th>
      <th class="day">SATURDAY</th>
    </tr>
  </thead>
  <tbody>
    <div id="event-row">
      <% for j in 0..15 %>
        <tr>
          <td class="event hour">
            <% if (7+j) <= 12 %><%= 7+j %> AM
            <% else %><%= 7+j-12 %> PM
            <% end%>
          </td>
          <% for i in 1..6 %>
            <td class="event">
            </td>
          <% end %>
        </tr>
      <% end %>
    </div>
  </tbody>
</table>

<div class="data">
  <table class="schedule table table-hover table-striped">
    <thead>
      <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      </tr>
    </thead>
    <tbody>
      <div id="event-row">
        <% for j in 0..15 %>
          <tr>
            <td class="event hour">
            </td>
            <% for i in 1..6 %>
              <td class="event">
                <% @schedule.events.each do |e| %>
                  <% if ((e.day_of_week.to_date.wday == i) && e.belongs_at_this_time(j) ) %>
                    <li class="list-group-item">
                    <div style="white-space:nowrap;">
                      <%= link_to "#", data: { toggle: "modal", "edit-event-path": "#{schedule_event_path(@schedule, e)}", event: e }, class:"edit-current-event" do %>
                          <%= e.name %><br>
                      <%end%>
                    </div>
                    </li>
                  <% end %>
                <% end %>
              </td>
            <% end %>
          </tr>
        <% end %>
      </div>
    </tbody>
  </table>
</div>


<%= render 'events/detail_event' %>

<script type="text/javascript">
  $(document).ready(function(){
    $(".edit-current-event").click(function(e){
      e.preventDefault();
      $("#edit_event_form").attr("action", $(this).data("edit-event-path"));
      $("#edit_event_form").attr("data-event",$(this).data("event").id);
      var eventJSON = $(this).data("event");
      $("#name_event").val(eventJSON["name"]);
      $("#start_event").val(eventJSON["inTime"]);
      $("#finish_event").val(eventJSON["outTime"]);
      $("#day_event").val(eventJSON["day_of_week"]);
      $("launch").val(eventJSON["launch"]);
      $("#detail-event").modal("show");
    })
  })
</script>
