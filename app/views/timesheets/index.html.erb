<%= render "timesheet_day" %>

<div id="date_ranges">
  <%= link_to "Today" , '#', :data => {:date => @today},:id => "today_date" %> 
</div>

<div role="tabpanel">

  <!-- Nav tabs -->
  <ul class="nav nav-tabs" role="tablist" id="myTab">
    <li role="presentation" data-date="<%= @start_of_week_day %>"><a href="#home" aria-controls="home" role="tab" data-toggle="tab"> <%= get_date_in_day_format @start_of_week_day %></a></li>
    <li role="presentation" data-date="<%= @start_of_week_day+1.days %>"><a href="#home" aria-controls="home" role="tab" data-toggle="tab" ><%=get_date_in_day_format ( @start_of_week_day + 1.days ) %></a></li>
    <li role="presentation" data-date="<%= @start_of_week_day+2.days %>"><a href="#home" aria-controls="home" role="tab" data-toggle="tab" ><%= get_date_in_day_format( @start_of_week_day + 2.days ) %></a></li>
    <li role="presentation" data-date="<%= @start_of_week_day+3.days %>"><a href="#home" aria-controls="home" role="tab" data-toggle="tab" ><%=get_date_in_day_format ( @start_of_week_day + 3.days ) %></a></li>
    <li role="presentation" data-date="<%= @start_of_week_day+4.days %>"><a href="#home" aria-controls="home" role="tab" data-toggle="tab" ><%=get_date_in_day_format ( @start_of_week_day + 4.days ) %></a></li>
    <li role="presentation" data-date="<%= @start_of_week_day+5.days %>"><a href="#home" aria-controls="home" role="tab" data-toggle="tab" ><%=get_date_in_day_format ( @start_of_week_day + 5.days ) %></a></li>
    <li role="presentation" data-date="<%= @start_of_week_day+6.days %>"><a href="#home" aria-controls="home" role="tab" data-toggle="tab" ><%= get_date_in_day_format ( @start_of_week_day + 6.days ) %></a></li>
  </ul>

  <!-- Tab panes -->
  <div class="tab-content">
    <div id="timesheet-content" role="tabpanel" class="tab-pane active" id="home"> 
        <%= render "timesheets" %>
    </div>
  </div>

  <!-- Button trigger modal -->
<button id="create-timer" type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">
  +
</button>

<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel"> Create new Timer <span> <%= @day_selected.strftime("%A, %b %d")  %> </span></h4>
      </div>
      <div id="new-timer-form" class="modal-body">
        <%= render "new_modal" %>
      </div>
    </div>
  </div>
</div>

</div>

<script type="text/javascript">

$('#myTab a').click(function (e) {
  e.preventDefault()
  $(this).tab('show')
  var parent = $(this).parent()[0];
  var dateForParam = parent.getAttribute("data-date");
  $.ajax({
    type:'GET', 
    url: "<%=timesheets_path%>", 
    data: { date : dateForParam },
    dataType: "script"
  });
})

$('#today_date').click(function(){
  console.log($(this))
  var dateForParam = $(this).data('date');
  $.ajax({
    type:'GET', 
    url: "<%=timesheets_path%>",
    dataType: "script"
  });
})

</script>